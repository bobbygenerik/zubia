import re
import sys

def test_no_sensitive_logging():
    filepath = 'server/main.py'
    with open(filepath, 'r') as f:
        content = f.read()

    # Find all logger.info calls
    logger_info_calls = re.findall(r'logger\.info\(f".*?"\)', content)

    sensitive_patterns = [r'\{text\}', r'\{translated\}']

    found_vulnerability = False
    for call in logger_info_calls:
        for pattern in sensitive_patterns:
            if re.search(pattern, call):
                print(f"Vulnerability found in call: {call}")
                found_vulnerability = True

    if found_vulnerability:
        print("FAILED: Sensitive data still logged.")
        sys.exit(1)
    else:
        print("PASSED: No sensitive data logged in logger.info calls.")
        sys.exit(0)

if __name__ == "__main__":
    test_no_sensitive_logging()
